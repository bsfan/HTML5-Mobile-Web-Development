<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="Content-Language" content="en"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>Tweetstr</title>
    <link rel="apple-touch-icon" href="../../../shared/images/tweetstr-icon.png"/>
    <link rel="stylesheet" href="html5reset.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="style.css" type="text/css" media="screen" charset="utf-8">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript" charset="utf-8">
      jQuery(function($){
        getTweets();
        
        var $nav = $('#navList');
        
        $nav.find('li').first().addClass('selected');
        $nav.find('a').live('click', function(e){
          $(this).parent().addClass('selected').siblings().removeClass('selected');
          navSelected(e);
          
          e.preventDefault();
          e.stopPropagation();
        });
        
        $('#tweetsList li img').live('click', function(e){
          var name = $(this).parent()[0].getAttribute('data-tweeter');
          $nav.find('li').removeClass('selected');
          getProfileForScreenName(name);
          
          e.preventDefault();
          e.stopPropagation();
        });
        
        function navSelected(event) {
          // Now give navItem the selected css class.
          var navItem = event.target;
          
          // Now do the right thing.
          switch (navItem.id) {
            case 'liHome':
              switchToSectionWithId('home');
              break;
            case 'liMentions':
              break;
            case 'liFaves':
              break;
          }
        }
        
        function getTweets() {
          $.getJSON("http://search.twitter.com/search.json?q=OReillyMedia&callback=?", function(json){
            var list = '';
            for (var resultId in json.results) {
              var result = json.results[resultId],
                  name = result.from_user,
                  text = result.text,
                  imageUrl = result.profile_image_url;
              
              list += '<li data-tweeter="'+name+'"><img src="'+imageUrl+'" alt="'+name+'" class="user-image"><span class="username">'+name+'</span><span class="message">'+text+'</span></li>';
            }
            $('#tweetsList').html(list);
          });
        }
        
        function switchToSectionWithId(sectionId) {
          $('#'+sectionId).addClass('selected').siblings().removeClass('selected');
        }
        
        function getProfileForScreenName(screenName) {
          $.getJSON("http://api.twitter.com/1/users/show.json?screen_name="+screenName+"&callback=?", function(json){
            var profile = json;

            // Get HTML Elements.
            var profileImage = document.getElementById('profileImage');
            profileImage.setAttribute('src', profile.profile_image_url);
            profileImage.setAttribute('alt', profile.name);
            
            var name = document.getElementById('name');
            name.innerText = profile.name;
            
            var screenName = document.getElementById('screenName');
            screenName.innerText = "@" + profile.screen_name;
            
            var location = document.getElementById('location');
            location.innerText = profile.location;
            
            var statusText = document.getElementById('statusText');
            statusText.innerText = profile.status.text;
            
            var followersCount = document.getElementById('followersCount');
            followersCount.innerText = "Followers: " + profile.followers_count;
            
            var friendsCount = document.getElementById('friendsCount');
            friendsCount.innerText = "Following: " + profile.friends_count;
            
            switchToSectionWithId('profile');
          });
        }

      });
    </script>
  </head>
</html>
  <body>
    <header>Tweetstr</header>
    <nav>
      <ul id='navList'>
        <li><a id='liHome' href="#home">Home</a></li>
        <li><a id='liMentions' href="#mentions">Mentions</a></li>
        <li><a id='liFaves' href="#favorites">Favorites</a></li>
        <li><a id='liMessages' href="#messages">Messages</a></li>
        <li><a id='liSearch' href="#search">Search</a></li>
      </ul>
    </nav>
    <section id='home' class='selected'>
      <ul id='tweetsList' class='tweets'></ul>
    </section>
    <section id='profile' class=''>
      <img id='profileImage' />
      <span id='name'></span>
      <span id='screenName'></span>
      <span id='location'></span>
      <span id='statusText'></span>
      <span id='followersCount'></span>
      <span id='friendsCount'></span>
    </section>
    <section id="mentions">Mentions</section>
    <section id="favorites">Favorites</section>
    <section id="messages">Messages</section>
    <section id="search">Search</section>
  </body>
</html>
